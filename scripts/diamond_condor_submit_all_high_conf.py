import os
from pathlib import Path
import time
import shutil
import pickle
import subprocess

import fire
import htcondor


SINGULARITY_SCRIPT = """#!/bin/bash

singularity exec -B /opt {personal_container_path} bash {pandda_script}
"""

SCRIPT = """#!/bin/bash

echo "In container!" 

. /xtal_software/ccp4/ccp4-7.1/bin/ccp4.setup-sh 
echo "CCP4" 

. /usr/local/phenix-1.19.2-4158/phenix_env.sh 
echo "phenix" 
. /xtal_software/GPhL/BUSTER_snapshot_20210716/setup.sh 
echo "gph" 
. /xtal_software/anaconda/bin/activate 
echo "conda" 
conda activate pandda2 
echo "pandda" 

python -u /dls/science/groups/i04-1/conor_dev/pandda_2_gemmi/pandda_gemmi/analyse.py --data_dirs={data_dirs} --out_dir={
out_dir} -_regex=\"dimple\" --mtz_regex=\"dimple.mtz\" --debug=True --only_datasets=\"{only_datasets}\"

echo "done pandda" 
"""

high_confidence_hits = [
    "ATAD2A-x1803",
    "ATAD2A-x1835",
    "BAZ2BA-x434",
    "BAZ2BA-x481",
    "BAZ2BA-x492",
    "BAZ2BA-x509",
    "BAZ2BA-x529",
    "BAZ2BA-x538",
    "BAZ2BA-x559",
    "BAZ2BA-x575",
    "BAZ2BA-x583",
    "CAMK1DA-x0049",
    "CAMK1DA-x0067",
    "CAMK1DA-x0083",
    "CAMK1DA-x0089",
    "CAMK1DA-x0091",
    "CAMK1DA-x0107",
    "CAMK1DA-x0145",
    "CAMK1DA-x0146",
    "CAMK1DA-x0168",
    "CAMK1DA-x0177",
    "CAMK1DA-x0204",
    "CAMK1DA-x0208",
    "CAMK1DA-x0218",
    "CAMK1DA-x0226",
    "CAMK1DA-x0253",
    "CAMK1DA-x0290",
    "CAMK1DA-x0297",
    "CAMK1DA-x0299",
    "CAMK1DA-x0321",
    "DCLRE1AA-x0128",
    "DCLRE1AA-x0135",
    "DCLRE1AA-x0139",
    "DCLRE1AA-x0150",
    "DCLRE1AA-x0157",
    "DCLRE1AA-x0164",
    "DCLRE1AA-x0169",
    "DCLRE1AA-x0172",
    "DCLRE1AA-x0183",
    "DCLRE1AA-x0193",
    "DCLRE1AA-x0194",
    "DCLRE1AA-x0195",
    "DCLRE1AA-x0209",
    "DCLRE1AA-x0233",
    "DCLRE1AA-x0234",
    "DCLRE1AA-x0925",
    "DCLRE1AA-x0928",
    "DCLRE1AA-x0965",
    "DCLRE1AA-x0968",
    "DCLRE1AA-x0972",
    "DCLRE1AA-x1010",
    "DCLRE1AA-x1012",
    "DCLRE1AA-x1013",
    "DCLRE1AA-x1015",
    "DCLRE1AA-x1074",
    "DCLRE1AA-x1085",
    "DCLRE1AA-x1087",
    "DCP2B-x0020",
    "DCP2B-x0033",
    "DCP2B-x0042",
    "DCP2B-x0067",
    "DCP2B-x0290",
    "DCP2B-x0340",
    "DCP2B-x0466",
    "DCP2B-x0533",
    "DCP2B-x0628",
    "DCP2B-x0996",
    "DCP2B-x1008",
    "DCP2B-x1010",
    "DCP2B-x1012",
    "DCP2B-x1019",
    "DCP2B-x1020",
    "DCP2B-x1021",
    "DCP2B-x1022",
    "DCP2B-x1023",
    "DCP2B-x1025",
    "DCP2B-x1032",
    "DCP2B-x1033",
    "DCP2B-x1035",
    "DCP2B-x1036",
    "DCP2B-x1037",
    "DCP2B-x1038",
    "DCP2B-x1039",
    "DCP2B-x1040",
    "DCP2B-x1042",
    "DCP2B-x1044",
    "DCP2B-x1046",
    "DCP2B-x1047",
    "DCP2B-x1048",
    "DCP2B-x1179",
    "DCP2B-x1214",
    "DCP2B-x1217",
    "DCP2B-x1225",
    "DCP2B-x1235",
    "DCP2B-x1246",
    "DCP2B-x1247",
    "DCP2B-x1254",
    "DCP2B-x1256",
    "DCP2B-x1257",
    "DCP2B-x1259",
    "DCP2B-x1264",
    "DCP2B-x1276",
    "DCP2B-x1344",
    "DCP2B-x1361",
    "DCP2B-x1362",
    "DCP2B-x1364",
    "DCP2B-x1367",
    "DCP2B-x1372",
    "DCP2B-x1374",
    "DCP2B-x1382",
    "DCP2B-x1386",
    "DCP2B-x1393",
    "DCP2B-x1396",
    "DCP2B-x1424",
    "DCP2B-x1475",
    "DCP2B-x1479",
    "DCP2B-x1502",
    "DCP2B-x1508",
    "DCP2B-x1518",
    "DCP2B-x1519",
    "DCP2B-x1521",
    "DCP2B-x1523",
    "DCP2B-x1524",
    "DCP2B-x1526",
    "DCP2B-x1527",
    "DCP2B-x1529",
    "DCP2B-x1532",
    "DCP2B-x1535",
    "DCP2B-x1538",
    "DCP2B-x1561",
    "EPB41L3A-x0076",
    "EPB41L3A-x0104",
    "EPB41L3A-x0105",
    "EPB41L3A-x0141",
    "EPB41L3A-x0150",
    "EPB41L3A-x0161",
    "EPB41L3A-x0162",
    "EPB41L3A-x0171",
    "EPB41L3A-x0175",
    "EPB41L3A-x0179",
    "EPB41L3A-x0182",
    "EPB41L3A-x0202",
    "EPB41L3A-x0209",
    "EPB41L3A-x0212",
    "EPB41L3A-x0224",
    "EPB41L3A-x0235",
    "EPB41L3A-x0244",
    "EPB41L3A-x0249",
    "EPB41L3A-x0267",
    "EPB41L3A-x0274",
    "EPB41L3A-x0305",
    "EPB41L3A-x0306",
    "EPB41L3A-x0316",
    "EPB41L3A-x0325",
    "EPB41L3A-x0337",
    "EPB41L3A-x0401",
    "EPB41L3A-x0403",
    "EPB41L3A-x0413",
    "EPB41L3A-x0419",
    "EPB41L3A-x0429",
    "EPB41L3A-x0455",
    "EPB41L3A-x0457",
    "EPB41L3A-x0463",
    "EPB41L3A-x0473",
    "EPB41L3A-x0475",
    "EPB41L3A-x0485",
    "EPB41L3A-x0494",
    "EPB41L3A-x0509",
    "EPB41L3A-x0520",
    "EPB41L3A-x0527",
    "EPB41L3A-x0538",
    "EPB41L3A-x0544",
    "EPB41L3A-x0547",
    "EPB41L3A-x0550",
    "EPB41L3A-x0556",
    "EPB41L3A-x0558",
    "EPB41L3A-x0575",
    "EPB41L3A-x0598",
    "EPB41L3A-x0601",
    "EPB41L3A-x0608",
    "EPB41L3A-x0630",
    "FALZA-x0079",
    "FALZA-x0085",
    "FALZA-x0172",
    "FALZA-x0177",
    "FALZA-x0271",
    "FALZA-x0309",
    "FALZA-x0402",
    "FALZA-x0438",
    "FAM83BA-x0131",
    "FAM83BA-x0168",
    "FAM83BA-x0183",
    "FAM83BA-x0285",
    "FAM83BA-x0786",
    "FAM83BA-x0813",
    "FAM83BA-x0837",
    "FAM83BA-x0958",
    "FAM83BA-x0963",
    "HAO1A-x0208",
    "HAO1A-x0368",
    "HAO1A-x0377",
    "HAO1A-x0438",
    "HAO1A-x0518",
    "HAO1A-x0523",
    "HAO1A-x0566",
    "HAO1A-x0567",
    "HAO1A-x0592",
    "HAO1A-x0599",
    "HAO1A-x0603",
    "HAO1A-x0604",
    "HAO1A-x0671",
    "HAO1A-x0678",
    "HAO1A-x0709",
    "HAO1A-x0713",
    "HAO1A-x0763",
    "HAO1A-x0808",
    "HAO1A-x0825",
    "HAO1A-x0826",
    "HAO1A-x0829",
    "HAO1A-x0841",
    "HAO1A-x0876",
    "HAO1A-x0889",
    "HAO1A-x0907",
    "INPP5DA-x0019",
    "INPP5DA-x0020",
    "INPP5DA-x0021",
    "INPP5DA-x0027",
    "INPP5DA-x0030",
    "INPP5DA-x0039",
    "INPP5DA-x0040",
    "INPP5DA-x0054",
    "INPP5DA-x0058",
    "INPP5DA-x0062",
    "INPP5DA-x0067",
    "INPP5DA-x0073",
    "INPP5DA-x0075",
    "INPP5DA-x0083",
    "INPP5DA-x0084",
    "INPP5DA-x0088",
    "INPP5DA-x0092",
    "INPP5DA-x0097",
    "INPP5DA-x0100",
    "INPP5DA-x0101",
    "INPP5DA-x0103",
    "INPP5DA-x0106",
    "INPP5DA-x0114",
    "INPP5DA-x0118",
    "INPP5DA-x0119",
    "INPP5DA-x0121",
    "INPP5DA-x0126",
    "INPP5DA-x0129",
    "INPP5DA-x0133",
    "INPP5DA-x0140",
    "INPP5DA-x0141",
    "INPP5DA-x0148",
    "INPP5DA-x0152",
    "INPP5DA-x0154",
    "INPP5DA-x0161",
    "INPP5DA-x0163",
    "INPP5DA-x0169",
    "INPP5DA-x0174",
    "INPP5DA-x0176",
    "INPP5DA-x0182",
    "INPP5DA-x0183",
    "INPP5DA-x0194",
    "INPP5DA-x0195",
    "INPP5DA-x0200",
    "INPP5DA-x0201",
    "INPP5DA-x0221",
    "INPP5DA-x0239",
    "INPP5DA-x0243",
    "INPP5DA-x0251",
    "INPP5DA-x0300",
    "INPP5DA-x0302",
    "INPP5DA-x0303",
    "INPP5DA-x0311",
    "INPP5DA-x0316",
    "INPP5DA-x0320",
    "INPP5DA-x0325",
    "INPP5DA-x0340",
    "INPP5DA-x0342",
    "INPP5DA-x0345",
    "INPP5DA-x0350",
    "INPP5DA-x0358",
    "INPP5DA-x0359",
    "INPP5DA-x0361",
    "INPP5DA-x0368",
    "INPP5DA-x0378",
    "INPP5DA-x0382",
    "INPP5DA-x0401",
    "INPP5DA-x0403",
    "INPP5DA-x0417",
    "INPP5DA-x0423",
    "INPP5DA-x0438",
    "INPP5DA-x0449",
    "INPP5DA-x0469",
    "INPP5DA-x0479",
    "INPP5DA-x0490",
    "INPP5DA-x0494",
    "INPP5DA-x0510",
    "INPP5DA-x0518",
    "INPP5DA-x0524",
    "INPP5DA-x0527",
    "INPP5DA-x0542",
    "INPP5DA-x0543",
    "INPP5DA-x0558",
    "INPP5DA-x0560",
    "INPP5DA-x0573",
    "INPP5DA-x0577",
    "INPP5DA-x0588",
    "INPP5DA-x0590",
    "INPP5DA-x0596",
    "INPP5DA-x0604",
    "INPP5DA-x0609",
    "mArh-1hjz",
    "mArh-1spv",
    "mArh-1vhu",
    "mArh-2bfq",
    "mArh-2fav",
    "mArh-3ew5",
    "mArh-3q6z",
    "mArh-3vfq",
    "mArh-4gvw",
    "mArh-4iqy",
    "mArh-4j4z",
    "mArh-5cb3",
    "mArh-5cb5",
    "mArh-5cms",
    "mArh-5dus",
    "mArh-5fud",
    "mArh-5l9k",
    "mArh-5lw0",
    "mArh-5mqx",
    "mArh-6fx7",
    "mArh-6mea",
    "mArh-6woj",
    "mArh-6ywk",
    "mArh-EU0034",
    "mArh-EU0046",
    "mArh-EU0056",
    "mArh-EU0087",
    "mArh-EU0123",
    "mArh-EU0144",
    "mArh-EU0172",
    "mArh-EU0238",
    "mArh-EU0241",
    "mArh-EU0291",
    "mArh-EU0293",
    "mArh-EU0342",
    "mArh-EU0424",
    "mArh-EU0481",
    "mArh-EU0526",
    "mArh-EU0569",
    "mArh-EU0704",
    "mArh-EU0716",
    "mArh-EU0744",
    "mArh-EU0815",
    "mArh-EU0844",
    "mArh-EU0860",
    "mArh-EU0906",
    "mArh-EU0960",
    "mArh-mac",
    "mArh-x0091",
    "mArh-x0104",
    "mArh-x0128",
    "mArh-x0142",
    "mArh-x0158",
    "mArh-x0159",
    "mArh-x0173",
    "mArh-x0216",
    "mArh-x0228",
    "mArh-x0253",
    "mArh-x0259",
    "mArh-x0282",
    "mArh-x0290",
    "mArh-x0299",
    "mArh-x0301",
    "mArh-x0334",
    "mArh-x0371",
    "mArh-x0380",
    "mArh-x0417",
    "mArh-x0421",
    "mArh-x0423",
    "mArh-x0436",
    "mArh-x0438",
    "mArh-x0465",
    "mArh-x0469",
    "mArh-x0471",
    "mArh-x0496",
    "mArh-x0516",
    "mArh-x0524",
    "mArh-x0548",
    "mArh-x0574",
    "mArh-x0587",
    "mArh-x0591",
    "mArh-x0592",
    "mArh-x0598",
    "mArh-x0600",
    "mArh-x0626",
    "mArh-x0628",
    "mArh-x0631",
    "mArh-x0655",
    "mArh-x0662",
    "mArh-x0676",
    "mArh-x0681",
    "mArh-x0685",
    "mArh-x0689",
    "mArh-x0711",
    "mArh-x0722",
    "mArh-x0724",
    "mArh-x0727",
    "mArh-x0729",
    "mArh-x0737",
    "mArh-x0742",
    "mArh-x0766",
    "mArh-x0792",
    "mArh-x0796",
    "mArh-x0797",
    "mArh-x0805",
    "mArh-x0814",
    "mArh-x0822",
    "mArh-x0837",
    "mArh-x0844",
    "mArh-x0849",
    "mArh-x0852",
    "mArh-x0855",
    "mArh-x0864",
    "mArh-x0895",
    "mArh-x0900",
    "mArh-x0905",
    "mArh-x0910",
    "mArh-x0918",
    "mArh-x0926",
    "mArh-x0933",
    "mArh-x0950",
    "mArh-x0962",
    "mArh-x0967",
    "mArh-x0969",
    "mArh-x1012",
    "mArh-x1015",
    "mArh-x1018",
    "mArh-x1092",
    "Mpro-N0029A",
    "Mpro-N0029B",
    "Mpro-N0050A",
    "Mpro-N0050B",
    "Mpro-N0066A",
    "Mpro-N0066B",
    "Mpro-x0072A",
    "Mpro-x0104A",
    "Mpro-x0107A",
    "Mpro-x0161A",
    "Mpro-x0165A",
    "Mpro-x0177A",
    "Mpro-x0194A",
    "Mpro-x0195A",
    "Mpro-x0305A",
    "Mpro-x0336A",
    "Mpro-x0350A",
    "Mpro-x0354A",
    "Mpro-x0376A",
    "Mpro-x0387A",
    "Mpro-x0390A",
    "Mpro-x0395A",
    "Mpro-x0397A",
    "Mpro-x0398A",
    "Mpro-x0425A",
    "Mpro-x0426A",
    "Mpro-x0434A",
    "Mpro-x0464A",
    "Mpro-x0478A",
    "Mpro-x0499A",
    "Mpro-x0540A",
    "Mpro-x0669A",
    "Mpro-x0678A",
    "Mpro-x0689A",
    "Mpro-x0691A",
    "Mpro-x0692A",
    "Mpro-x0705A",
    "Mpro-x0708A",
    "Mpro-x0731A",
    "Mpro-x0734A",
    "Mpro-x0736A",
    "Mpro-x0749A",
    "Mpro-x0752A",
    "Mpro-x0755A",
    "Mpro-x0755",
    "Mpro-x0759A",
    "Mpro-x0769A",
    "Mpro-x0769",
    "Mpro-x0770A",
    "Mpro-x0771A",
    "Mpro-x0774A",
    "Mpro-x0786A",
    "Mpro-x0820A",
    "Mpro-x0830A",
    "Mpro-x0831A",
    "Mpro-x0874A",
    "Mpro-x0887A",
    "Mpro-x0946A",
    "Mpro-x0967A",
    "Mpro-x0978A",
    "Mpro-x0981A",
    "Mpro-x0991A",
    "Mpro-x0995A",
    "Mpro-x10019A",
    "Mpro-x10022A",
    "Mpro-x1002A",
    "Mpro-x10049A",
    "Mpro-x10082A",
    "Mpro-x1012A",
    "Mpro-x10150A",
    "Mpro-x10155A",
    "Mpro-x10172A",
    "Mpro-x10178A",
    "Mpro-x10201A",
    "Mpro-x10236A",
    "Mpro-x10237A",
    "Mpro-x10247A",
    "Mpro-x10248A",
    "Mpro-x10296A",
    "Mpro-x10306A",
    "Mpro-x10314A",
    "Mpro-x10322A",
    "Mpro-x10324A",
    "Mpro-x10327A",
    "Mpro-x10329A",
    "Mpro-x10334A",
    "Mpro-x10338A",
    "Mpro-x10355A",
    "Mpro-x10359A",
    "Mpro-x10371A",
    "Mpro-x10377A",
    "Mpro-x10387A",
    "Mpro-x10392A",
    "Mpro-x10395A",
    "Mpro-x10396A",
    "Mpro-x10403A",
    "Mpro-x10417A",
    "Mpro-x10419A",
    "Mpro-x10421A",
    "Mpro-x10422A",
    "Mpro-x10423A",
    "Mpro-x10466A",
    "Mpro-x10473A",
    "Mpro-x10474A",
    "Mpro-x10476A",
    "Mpro-x10478A",
    "Mpro-x10484A",
    "Mpro-x10488A",
    "Mpro-x10494A",
    "Mpro-x10506A",
    "Mpro-x10513A",
    "Mpro-x10525A",
    "Mpro-x10535A",
    "Mpro-x10555A",
    "Mpro-x10559A",
    "Mpro-x10565A",
    "Mpro-x10566A",
    "Mpro-x10575A",
    "Mpro-x10598A",
    "Mpro-x10604A",
    "Mpro-x10606A",
    "Mpro-x10610A",
    "Mpro-x10626A",
    "Mpro-x10638A",
    "Mpro-x10645A",
    "Mpro-x10678A",
    "Mpro-x10679A",
    "Mpro-x10700A",
    "Mpro-x10710A",
    "Mpro-x10723A",
    "Mpro-x10728A",
    "Mpro-x10733A",
    "Mpro-x10756A",
    "Mpro-x1077A",
    "Mpro-x10787A",
    "Mpro-x10789A",
    "Mpro-x10800A",
    "Mpro-x10801A",
    "Mpro-x10812A",
    "Mpro-x10820A",
    "Mpro-x10834A",
    "Mpro-x10856A",
    "Mpro-x10862A",
    "Mpro-x10862",
    "Mpro-x1086A",
    "Mpro-x10870A",
    "Mpro-x10871A",
    "Mpro-x10876A",
    "Mpro-x10888A",
    "Mpro-x10889A",
    "Mpro-x10889",
    "Mpro-x10898A",
    "Mpro-x10899A",
    "Mpro-x10900A",
    "Mpro-x10906A",
    "Mpro-x1093A",
    "Mpro-x10942A",
    "Mpro-x10959A",
    "Mpro-x10976A",
    "Mpro-x10995A",
    "Mpro-x10996A",
    "Mpro-x11001A",
    "Mpro-x11011A",
    "Mpro-x11013A",
    "Mpro-x1101A",
    "Mpro-x1101",
    "Mpro-x11025A",
    "Mpro-x11041A",
    "Mpro-x11044A",
    "Mpro-x11159A",
    "Mpro-x11164A",
    "Mpro-x11186A",
    "Mpro-x1119A",
    "Mpro-x1119",
    "Mpro-x11204A",
    "Mpro-x11208A",
    "Mpro-x11212A",
    "Mpro-x11223A",
    "Mpro-x11225A",
    "Mpro-x11231A",
    "Mpro-x11233A",
    "Mpro-x11254A",
    "Mpro-x11258A",
    "Mpro-x11271A",
    "Mpro-x11276A",
    "Mpro-x11294A",
    "Mpro-x11313A",
    "Mpro-x11317A",
    "Mpro-x11318A",
    "Mpro-x1132A",
    "Mpro-x11339A",
    "Mpro-x11346A",
    "Mpro-x11354A",
    "Mpro-x11366A",
    "Mpro-x11368A",
    "Mpro-x11372A",
    "Mpro-x11417A",
    "Mpro-x11424A",
    "Mpro-x11426A",
    "Mpro-x11427A",
    "Mpro-x11428A",
    "Mpro-x11431A",
    "Mpro-x11432A",
    "Mpro-x11454A",
    "Mpro-x11458A",
    "Mpro-x11473A",
    "Mpro-x11475A",
    "Mpro-x11485A",
    "Mpro-x11488A",
    "Mpro-x11493A",
    "Mpro-x11498A",
    "Mpro-x11499A",
    "Mpro-x11501A",
    "Mpro-x11507A",
    "Mpro-x11508A",
    "Mpro-x11513A",
    "Mpro-x11530A",
    "Mpro-x11532A",
    "Mpro-x11540A",
    "Mpro-x11541A",
    "Mpro-x11542A",
    "Mpro-x11543A",
    "Mpro-x11548A",
    "Mpro-x11557A",
    "Mpro-x11560A",
    "Mpro-x11562A",
    "Mpro-x11564A",
    "Mpro-x11579A",
    "Mpro-x11587A",
    "Mpro-x11590A",
    "Mpro-x11609A",
    "Mpro-x11612A",
    "Mpro-x11616A",
    "Mpro-x1163A",
    "Mpro-x11641A",
    "Mpro-x11642A",
    "Mpro-x11708A",
    "Mpro-x11723A",
    "Mpro-x11742A",
    "Mpro-x11743A",
    "Mpro-x11757A",
    "Mpro-x11764A",
    "Mpro-x11789A",
    "Mpro-x11790A",
    "Mpro-x11797A",
    "Mpro-x11798A",
    "Mpro-x11801A",
    "Mpro-x11809A",
    "Mpro-x11810A",
    "Mpro-x11812A",
    "Mpro-x11813A",
    "Mpro-x11831A",
    "Mpro-x11852A",
    "Mpro-x1187A",
    "Mpro-x11894A",
    "Mpro-x12000A",
    "Mpro-x12025A",
    "Mpro-x12025",
    "Mpro-x12026A",
    "Mpro-x12064A",
    "Mpro-x12073A",
    "Mpro-x12080A",
    "Mpro-x12136A",
    "Mpro-x12143A",
    "Mpro-x12171A",
    "Mpro-x12177A",
    "Mpro-x12202A",
    "Mpro-x12204A",
    "Mpro-x12207A",
    "Mpro-x1226A",
    "Mpro-x12300A",
    "Mpro-x12321A",
    "Mpro-x12350A",
    "Mpro-x1235A",
    "Mpro-x1235",
    "Mpro-x1237A",
    "Mpro-x12419A",
    "Mpro-x12423A",
    "Mpro-x1249A",
    "Mpro-x1308A",
    "Mpro-x1308",
    "Mpro-x1311A",
    "Mpro-x1334A",
    "Mpro-x1334",
    "Mpro-x1336A",
    "Mpro-x1348A",
    "Mpro-x1351A",
    "Mpro-x1358A",
    "Mpro-x1374A",
    "Mpro-x1375A",
    "Mpro-x1380A",
    "Mpro-x1382A",
    "Mpro-x1384A",
    "Mpro-x1385A",
    "Mpro-x1386A",
    "Mpro-x1392A",
    "Mpro-x1402A",
    "Mpro-x1412A",
    "Mpro-x1418A",
    "Mpro-x1425A",
    "Mpro-x1458A",
    "Mpro-x1478A",
    "Mpro-x1493A",
    "Mpro-x2052A",
    "Mpro-x2097A",
    "Mpro-x2119A",
    "Mpro-x2193A",
    "Mpro-x2540A",
    "Mpro-x2562A",
    "Mpro-x2563A",
    "Mpro-x2569A",
    "Mpro-x2572A",
    "Mpro-x2581A",
    "Mpro-x2600A",
    "Mpro-x2608A",
    "Mpro-x2643A",
    "Mpro-x2646A",
    "Mpro-x2649A",
    "Mpro-x2659A",
    "Mpro-x2694A",
    "Mpro-x2703A",
    "Mpro-x2705A",
    "Mpro-x2754A",
    "Mpro-x2764A",
    "Mpro-x2776A",
    "Mpro-x2779A",
    "Mpro-x2908A",
    "Mpro-x2910A",
    "Mpro-x2912A",
    "Mpro-x2929A",
    "Mpro-x2964A",
    "Mpro-x2971A",
    "Mpro-x3077A",
    "Mpro-x3080A",
    "Mpro-x3108A",
    "Mpro-x3110A",
    "Mpro-x3113A",
    "Mpro-x3115A",
    "Mpro-x3117A",
    "Mpro-x3124A",
    "Mpro-x3298A",
    "Mpro-x3303A",
    "Mpro-x3305A",
    "Mpro-x3305",
    "Mpro-x3324A",
    "Mpro-x3325A",
    "Mpro-x3333A",
    "Mpro-x3348A",
    "Mpro-x3351A",
    "Mpro-x3351",
    "Mpro-x3359A",
    "Mpro-x3366A",
    "MUREECA-x0114",
    "MUREECA-x0164",
    "MUREECA-x0169",
    "MUREECA-x0172",
    "MUREECA-x0198",
    "MUREECA-x0206",
    "MUREECA-x0215",
    "MUREECA-x0234",
    "MUREECA-x0244",
    "NUDT21A-x0159",
    "NUDT21A-x0203",
    "NUDT21A-x0266",
    "NUDT21A-x0368",
    "NUDT21A-x0404",
    "NUDT21A-x0489",
    "NUDT21A-x0498",
    "NUDT21A-x0502",
    "NUDT21A-x0503",
    "NUDT21A-x0581",
    "NUDT21A-x0584",
    "NUDT21A-x0659",
    "NUDT21A-x0703",
    "NUDT21A-x0743",
    "NUDT21A-x0750",
    "NUDT21A-x0798",
    "NUDT21A-x0896",
    "NUDT21A-x0930",
    "NUDT21A-x0935",
    "NUDT21A-x0936",
    "NUDT21A-x0942",
    "NUDT21A-x0948",
    "NUDT21A-x0964",
    "NUDT21A-x0967",
    "NUDT21A-x0969",
    "NUDT21A-x0974",
    "NUDT21A-x0976",
    "NUDT21A-x1046",
    "NUDT21A-x1047",
    "NUDT21A-x1065",
    "NUDT21A-x1068",
    "NUDT5A-x0114",
    "NUDT5A-x0125",
    "NUDT5A-x0158",
    "NUDT5A-x0169",
    "NUDT5A-x0171",
    "NUDT5A-x0176",
    "NUDT5A-x0177",
    "NUDT5A-x0244",
    "NUDT5A-x0256",
    "NUDT5A-x0262",
    "NUDT5A-x0286",
    "NUDT5A-x0299",
    "NUDT5A-x0319",
    "NUDT5A-x0320",
    "NUDT5A-x0333",
    "NUDT5A-x0339",
    "NUDT5A-x0392",
    "NUDT5A-x0403",
    "NUDT5A-x0412",
    "NUDT5A-x0463",
    "NUDT5A-x0469",
    "NUDT5A-x0525",
    "NUDT5A-x0526",
    "NUDT5A-x0552",
    "NUDT5A-x0554",
    "NUDT5A-x0574",
    "NUDT5A-x0600",
    "NUDT5A-x0605",
    "NUDT5A-x0627",
    "NUDT5A-x0637",
    "NUDT5A-x0651",
    "NUDT5A-x0673",
    "NUDT5A-x0681",
    "NUDT5A-x0685",
    "NUDT5A-x0692",
    "NUDT5A-x1004",
    "NUDT5A-x1024",
    "NUDT5A-x1028",
    "NUDT5A-x1039",
    "NUDT5A-x1066",
    "NUDT5A-x1072",
    "NUDT5A-x1078",
    "NUDT5A-x1083",
    "NUDT5A-x1093",
    "NUDT5A-x1211",
    "NUDT5A-x1212",
    "NUDT5A-x1213",
    "NUDT5A-x1214",
    "NUDT5A-x1217",
    "NUDT5A-x1219",
    "NUDT5A-x1223",
    "NUDT5A-x1235",
    "NUDT5A-x1242",
    "NUDT5A-x1291",
    "NUDT5A-x1298",
    "NUDT7A-x0140",
    "NUDT7A-x0149",
    "NUDT7A-x0151",
    "NUDT7A-x0159",
    "NUDT7A-x0220",
    "NUDT7A-x0254",
    "NUDT7A-x0286",
    "NUDT7A-x0299",
    "NUDT7A-x0303",
    "NUDT7A-x0304",
    "NUDT7A-x0374",
    "OXA10OTA-x0038",
    "OXA10OTA-x0049",
    "OXA10OTA-x0051",
    "OXA10OTA-x0053",
    "OXA10OTA-x0059",
    "OXA10OTA-x0073",
    "OXA10OTA-x0074",
    "OXA10OTA-x0079",
    "OXA10OTA-x0106",
    "OXA10OTA-x0108",
    "PARP14A-x0137",
    "PARP14A-x0161",
    "PARP14A-x0202",
    "PARP14A-x0238",
    "PARP14A-x0266",
    "PARP14A-x0315",
    "PARP14A-x0324",
    "PARP14A-x0334",
    "PARP14A-x0412",
    "PARP14A-x0457",
    "PARP14A-x0473",
    "PARP14A-x0484",
    "PARP14A-x0505",
    "PARP14A-x0567",
    "PARP14A-x0590",
    "PARP14A-x0637",
    "PARP14A-x0690",
    "PARP14A-x0712",
    "PHIPA-x20023",
    "PHIPA-x20028",
    "PHIPA-x20029",
    "PHIPA-x20030",
    "PHIPA-x20033",
    "PHIPA-x20045",
    "PHIPA-x20062",
    "PHIPA-x20065",
    "PHIPA-x20076",
    "PHIPA-x20167",
    "PHIPA-x20175",
    "PHIPA-x20330",
    "PHIPA-x20337",
    "PHIPA-x20370",
    "PHIPA-x20404",
    "PHIPA-x20442",
    "PHIPA-x20453",
    "PHIPA-x20463",
    "PHIPA-x20477",
    "PHIPA-x20485",
    "PHIPA-x20529",
    "PHIPA-x20548",
    "PHIPA-x20551",
    "PHIPA-x20552",
    "PHIPA-x20561",
    "PHIPA-x20566",
    "PHIPA-x20584",
    "PHIPA-x20594",
    "PHIPA-x20595",
    "PHIPA-x20631",
    "PHIPA-x20633",
    "PHIPA-x20651",
    "PHIPA-x20667",
    "PHIPA-x20671",
    "PHIPA-x20678",
    "PHIPA-x20712",
    "PHIPA-x20719",
    "PHIPA-x20767",
    "PHIPA-x20801",
    "PHIPA-x20826",
    "PHIPA-x20831",
    "PHIPA-x20833",
    "PHIPA-x20890",
    "PHIPA-x20899",
    "PHIPA-x20906",
    "PHIPA-x20910",
    "PHIPA-x20916",
    "PHIPA-x20971",
    "PHIPA-x21004",
    "STAG1A-x0237",
    "STAG1A-x0245",
    "STAG1A-x0457",
    "STAG1A-x0488",
    "STAG1A-x0515",
    "STAG1A-x0521",
    "STAG1A-x0531",
    "STAG1A-x0583",
    "STAG1A-x0627",
    "STAG1A-x0720",
    "STAG1A-x0894",
    "STAG1A-x0921",
    "STAG1A-x0996",
    "STAG1A-x1055",
    "TBXTA-x0024",
    "TBXTA-x0076",
    "TBXTA-x0093",
    "TBXTA-x0096",
    "TBXTA-x0113",
    "TBXTA-x0114",
    "TBXTA-x0124",
    "TBXTA-x0128",
    "TBXTA-x0144",
    "TBXTA-x0164",
    "TBXTA-x0167",
    "TBXTA-x0179",
    "TBXTA-x0204",
    "TBXTA-x0229",
    "TBXTA-x0244",
    "TBXTA-x0249",
    "TBXTA-x0258",
    "TBXTA-x0316",
    "TBXTA-x0338",
    "TBXTA-x0353",
    "TBXTA-x0368",
    "TBXTA-x0390",
    "TBXTA-x0409",
    "TBXTA-x0464",
    "TBXTA-x0465",
    "TBXTA-x0491",
    "TBXTA-x0500",
    "TBXTA-x0506",
    "TBXTA-x0530",
    "TBXTA-x0545",
    "TBXTA-x0552",
    "TBXTA-x0563",
    "TBXTA-x0567",
    "TBXTA-x0744",
    "TBXTA-x0753",
    "TBXTA-x0773",
    "TBXTA-x0776",
    "TBXTA-x0786",
    "TBXTA-x0820",
    "TBXTA-x0830",
    "TBXTA-x0835",
    "TBXTA-x0938",
    "TBXTA-x0948",
    "TBXTA-x0986",
    "TBXTA-x0992",
    "TBXTA-x1079",
    "TBXTA-x1161",
    "TBXTA-x1164",
    "TBXTA-x1174",
    "TNCA-x0062",
    "TNCA-x0063",
    "TNCA-x0084",
    "TNCA-x0100",
    "TNCA-x0107",
    "TNCA-x0141",
    "TNCA-x0146",
    "TNCA-x0162",
    "TNCA-x0179",
    "TNCA-x0192",
    "TNCA-x0228",
    "TNCA-x0245",
    "TNCA-x0290",
    "TNCA-x0291",
    "TNCA-x0296",
    "TNCA-x0323",
    "TNCA-x0334",
    "VIM2-x1057",
    "VIM2-x1237",
    "VIM2-x1238",
    "VIM2-x1243",
    "VIM2-x1247",
    "VIM2-x1251",
    "VIM2-x1261",
    "VIM2-x1264",
    "VIM2-x1282",
    "VIM2-x1291",
    "VIM2-x1294",
    "XX02KALRNA-x1376",
    "XX02KALRNA-x1377",
    "XX02KALRNA-x1388",
    "XX02KALRNA-x1389",
    "XX02KALRNA-x1449",
    "XX02KALRNA-x1453",
    "XX02KALRNA-x1463",
    "XX02KALRNA-x1480",
    "XX02KALRNA-x1483",
    "XX02KALRNA-x1490",
    "XX02KALRNA-x1492",
    "XX02KALRNA-x1505",
]

high_confidence_structure_dict = {
    "ATAD2A": [
        "ATAD2A-x1803",
        "ATAD2A-x1835",
    ],
    "BAZ2BA": [
        "BAZ2BA-x434",
        "BAZ2BA-x481",
        "BAZ2BA-x492",
        "BAZ2BA-x509",
        "BAZ2BA-x529",
        "BAZ2BA-x538",
        "BAZ2BA-x559",
        "BAZ2BA-x575",
        "BAZ2BA-x583",
    ],
    "CAMK1DA": [
        "CAMK1DA-x0049",
        "CAMK1DA-x0067",
        "CAMK1DA-x0083",
        "CAMK1DA-x0089",
        "CAMK1DA-x0091",
        "CAMK1DA-x0107",
        "CAMK1DA-x0145",
        "CAMK1DA-x0146",
        "CAMK1DA-x0168",
        "CAMK1DA-x0177",
        "CAMK1DA-x0204",
        "CAMK1DA-x0208",
        "CAMK1DA-x0218",
        "CAMK1DA-x0226",
        "CAMK1DA-x0253",
        "CAMK1DA-x0290",
        "CAMK1DA-x0297",
        "CAMK1DA-x0299",
        "CAMK1DA-x0321",
    ],

    "DCLRE1AA": [
        "DCLRE1AA-x0128",
        "DCLRE1AA-x0135",
        "DCLRE1AA-x0139",
        "DCLRE1AA-x0150",
        "DCLRE1AA-x0157",
        "DCLRE1AA-x0164",
        "DCLRE1AA-x0169",
        "DCLRE1AA-x0172",
        "DCLRE1AA-x0183",
        "DCLRE1AA-x0193",
        "DCLRE1AA-x0194",
        "DCLRE1AA-x0195",
        "DCLRE1AA-x0209",
        "DCLRE1AA-x0233",
        "DCLRE1AA-x0234",
        "DCLRE1AA-x0925",
        "DCLRE1AA-x0928",
        "DCLRE1AA-x0965",
        "DCLRE1AA-x0968",
        "DCLRE1AA-x0972",
        "DCLRE1AA-x1010",
        "DCLRE1AA-x1012",
        "DCLRE1AA-x1013",
        "DCLRE1AA-x1015",
        "DCLRE1AA-x1074",
        "DCLRE1AA-x1085",
        "DCLRE1AA-x1087",
    ],

    "DCP2B": [
        "DCP2B-x0020",
        "DCP2B-x0033",
        "DCP2B-x0042",
        "DCP2B-x0067",
        "DCP2B-x0290",
        "DCP2B-x0340",
        "DCP2B-x0466",
        "DCP2B-x0533",
        "DCP2B-x0628",
        "DCP2B-x0996",
        "DCP2B-x1008",
        "DCP2B-x1010",
        "DCP2B-x1012",
        "DCP2B-x1019",
        "DCP2B-x1020",
        "DCP2B-x1021",
        "DCP2B-x1022",
        "DCP2B-x1023",
        "DCP2B-x1025",
        "DCP2B-x1032",
        "DCP2B-x1033",
        "DCP2B-x1035",
        "DCP2B-x1036",
        "DCP2B-x1037",
        "DCP2B-x1038",
        "DCP2B-x1039",
        "DCP2B-x1040",
        "DCP2B-x1042",
        "DCP2B-x1044",
        "DCP2B-x1046",
        "DCP2B-x1047",
        "DCP2B-x1048",
        "DCP2B-x1179",
        "DCP2B-x1214",
        "DCP2B-x1217",
        "DCP2B-x1225",
        "DCP2B-x1235",
        "DCP2B-x1246",
        "DCP2B-x1247",
        "DCP2B-x1254",
        "DCP2B-x1256",
        "DCP2B-x1257",
        "DCP2B-x1259",
        "DCP2B-x1264",
        "DCP2B-x1276",
        "DCP2B-x1344",
        "DCP2B-x1361",
        "DCP2B-x1362",
        "DCP2B-x1364",
        "DCP2B-x1367",
        "DCP2B-x1372",
        "DCP2B-x1374",
        "DCP2B-x1382",
        "DCP2B-x1386",
        "DCP2B-x1393",
        "DCP2B-x1396",
        "DCP2B-x1424",
        "DCP2B-x1475",
        "DCP2B-x1479",
        "DCP2B-x1502",
        "DCP2B-x1508",
        "DCP2B-x1518",
        "DCP2B-x1519",
        "DCP2B-x1521",
        "DCP2B-x1523",
        "DCP2B-x1524",
        "DCP2B-x1526",
        "DCP2B-x1527",
        "DCP2B-x1529",
        "DCP2B-x1532",
        "DCP2B-x1535",
        "DCP2B-x1538",
        "DCP2B-x1561",
    ],
    "EPB41L3A": [
        "EPB41L3A-x0076",
        "EPB41L3A-x0104",
        "EPB41L3A-x0105",
        "EPB41L3A-x0141",
        "EPB41L3A-x0150",
        "EPB41L3A-x0161",
        "EPB41L3A-x0162",
        "EPB41L3A-x0171",
        "EPB41L3A-x0175",
        "EPB41L3A-x0179",
        "EPB41L3A-x0182",
        "EPB41L3A-x0202",
        "EPB41L3A-x0209",
        "EPB41L3A-x0212",
        "EPB41L3A-x0224",
        "EPB41L3A-x0235",
        "EPB41L3A-x0244",
        "EPB41L3A-x0249",
        "EPB41L3A-x0267",
        "EPB41L3A-x0274",
        "EPB41L3A-x0305",
        "EPB41L3A-x0306",
        "EPB41L3A-x0316",
        "EPB41L3A-x0325",
        "EPB41L3A-x0337",
        "EPB41L3A-x0401",
        "EPB41L3A-x0403",
        "EPB41L3A-x0413",
        "EPB41L3A-x0419",
        "EPB41L3A-x0429",
        "EPB41L3A-x0455",
        "EPB41L3A-x0457",
        "EPB41L3A-x0463",
        "EPB41L3A-x0473",
        "EPB41L3A-x0475",
        "EPB41L3A-x0485",
        "EPB41L3A-x0494",
        "EPB41L3A-x0509",
        "EPB41L3A-x0520",
        "EPB41L3A-x0527",
        "EPB41L3A-x0538",
        "EPB41L3A-x0544",
        "EPB41L3A-x0547",
        "EPB41L3A-x0550",
        "EPB41L3A-x0556",
        "EPB41L3A-x0558",
        "EPB41L3A-x0575",
        "EPB41L3A-x0598",
        "EPB41L3A-x0601",
        "EPB41L3A-x0608",
        "EPB41L3A-x0630",
    ],
    "FALZA": [
        "FALZA-x0079",
        "FALZA-x0085",
        "FALZA-x0172",
        "FALZA-x0177",
        "FALZA-x0271",
        "FALZA-x0309",
        "FALZA-x0402",
        "FALZA-x0438",
    ],

    "FAM83BA": [
        "FAM83BA-x0131",
        "FAM83BA-x0168",
        "FAM83BA-x0183",
        "FAM83BA-x0285",
        "FAM83BA-x0786",
        "FAM83BA-x0813",
        "FAM83BA-x0837",
        "FAM83BA-x0958",
        "FAM83BA-x0963",
    ],
    "HAO1A": [
        "HAO1A-x0208",
        "HAO1A-x0368",
        "HAO1A-x0377",
        "HAO1A-x0438",
        "HAO1A-x0518",
        "HAO1A-x0523",
        "HAO1A-x0566",
        "HAO1A-x0567",
        "HAO1A-x0592",
        "HAO1A-x0599",
        "HAO1A-x0603",
        "HAO1A-x0604",
        "HAO1A-x0671",
        "HAO1A-x0678",
        "HAO1A-x0709",
        "HAO1A-x0713",
        "HAO1A-x0763",
        "HAO1A-x0808",
        "HAO1A-x0825",
        "HAO1A-x0826",
        "HAO1A-x0829",
        "HAO1A-x0841",
        "HAO1A-x0876",
        "HAO1A-x0889",
        "HAO1A-x0907",
    ],
    "INPP5DA": [
        "INPP5DA-x0019",
        "INPP5DA-x0020",
        "INPP5DA-x0021",
        "INPP5DA-x0027",
        "INPP5DA-x0030",
        "INPP5DA-x0039",
        "INPP5DA-x0040",
        "INPP5DA-x0054",
        "INPP5DA-x0058",
        "INPP5DA-x0062",
        "INPP5DA-x0067",
        "INPP5DA-x0073",
        "INPP5DA-x0075",
        "INPP5DA-x0083",
        "INPP5DA-x0084",
        "INPP5DA-x0088",
        "INPP5DA-x0092",
        "INPP5DA-x0097",
        "INPP5DA-x0100",
        "INPP5DA-x0101",
        "INPP5DA-x0103",
        "INPP5DA-x0106",
        "INPP5DA-x0114",
        "INPP5DA-x0118",
        "INPP5DA-x0119",
        "INPP5DA-x0121",
        "INPP5DA-x0126",
        "INPP5DA-x0129",
        "INPP5DA-x0133",
        "INPP5DA-x0140",
        "INPP5DA-x0141",
        "INPP5DA-x0148",
        "INPP5DA-x0152",
        "INPP5DA-x0154",
        "INPP5DA-x0161",
        "INPP5DA-x0163",
        "INPP5DA-x0169",
        "INPP5DA-x0174",
        "INPP5DA-x0176",
        "INPP5DA-x0182",
        "INPP5DA-x0183",
        "INPP5DA-x0194",
        "INPP5DA-x0195",
        "INPP5DA-x0200",
        "INPP5DA-x0201",
        "INPP5DA-x0221",
        "INPP5DA-x0239",
        "INPP5DA-x0243",
        "INPP5DA-x0251",
        "INPP5DA-x0300",
        "INPP5DA-x0302",
        "INPP5DA-x0303",
        "INPP5DA-x0311",
        "INPP5DA-x0316",
        "INPP5DA-x0320",
        "INPP5DA-x0325",
        "INPP5DA-x0340",
        "INPP5DA-x0342",
        "INPP5DA-x0345",
        "INPP5DA-x0350",
        "INPP5DA-x0358",
        "INPP5DA-x0359",
        "INPP5DA-x0361",
        "INPP5DA-x0368",
        "INPP5DA-x0378",
        "INPP5DA-x0382",
        "INPP5DA-x0401",
        "INPP5DA-x0403",
        "INPP5DA-x0417",
        "INPP5DA-x0423",
        "INPP5DA-x0438",
        "INPP5DA-x0449",
        "INPP5DA-x0469",
        "INPP5DA-x0479",
        "INPP5DA-x0490",
        "INPP5DA-x0494",
        "INPP5DA-x0510",
        "INPP5DA-x0518",
        "INPP5DA-x0524",
        "INPP5DA-x0527",
        "INPP5DA-x0542",
        "INPP5DA-x0543",
        "INPP5DA-x0558",
        "INPP5DA-x0560",
        "INPP5DA-x0573",
        "INPP5DA-x0577",
        "INPP5DA-x0588",
        "INPP5DA-x0590",
        "INPP5DA-x0596",
        "INPP5DA-x0604",
        "INPP5DA-x0609",
    ],
    "mArh": [
        "mArh-1hjz",
        "mArh-1spv",
        "mArh-1vhu",
        "mArh-2bfq",
        "mArh-2fav",
        "mArh-3ew5",
        "mArh-3q6z",
        "mArh-3vfq",
        "mArh-4gvw",
        "mArh-4iqy",
        "mArh-4j4z",
        "mArh-5cb3",
        "mArh-5cb5",
        "mArh-5cms",
        "mArh-5dus",
        "mArh-5fud",
        "mArh-5l9k",
        "mArh-5lw0",
        "mArh-5mqx",
        "mArh-6fx7",
        "mArh-6mea",
        "mArh-6woj",
        "mArh-6ywk",
        "mArh-EU0034",
        "mArh-EU0046",
        "mArh-EU0056",
        "mArh-EU0087",
        "mArh-EU0123",
        "mArh-EU0144",
        "mArh-EU0172",
        "mArh-EU0238",
        "mArh-EU0241",
        "mArh-EU0291",
        "mArh-EU0293",
        "mArh-EU0342",
        "mArh-EU0424",
        "mArh-EU0481",
        "mArh-EU0526",
        "mArh-EU0569",
        "mArh-EU0704",
        "mArh-EU0716",
        "mArh-EU0744",
        "mArh-EU0815",
        "mArh-EU0844",
        "mArh-EU0860",
        "mArh-EU0906",
        "mArh-EU0960",
        "mArh-mac",
        "mArh-x0091",
        "mArh-x0104",
        "mArh-x0128",
        "mArh-x0142",
        "mArh-x0158",
        "mArh-x0159",
        "mArh-x0173",
        "mArh-x0216",
        "mArh-x0228",
        "mArh-x0253",
        "mArh-x0259",
        "mArh-x0282",
        "mArh-x0290",
        "mArh-x0299",
        "mArh-x0301",
        "mArh-x0334",
        "mArh-x0371",
        "mArh-x0380",
        "mArh-x0417",
        "mArh-x0421",
        "mArh-x0423",
        "mArh-x0436",
        "mArh-x0438",
        "mArh-x0465",
        "mArh-x0469",
        "mArh-x0471",
        "mArh-x0496",
        "mArh-x0516",
        "mArh-x0524",
        "mArh-x0548",
        "mArh-x0574",
        "mArh-x0587",
        "mArh-x0591",
        "mArh-x0592",
        "mArh-x0598",
        "mArh-x0600",
        "mArh-x0626",
        "mArh-x0628",
        "mArh-x0631",
        "mArh-x0655",
        "mArh-x0662",
        "mArh-x0676",
        "mArh-x0681",
        "mArh-x0685",
        "mArh-x0689",
        "mArh-x0711",
        "mArh-x0722",
        "mArh-x0724",
        "mArh-x0727",
        "mArh-x0729",
        "mArh-x0737",
        "mArh-x0742",
        "mArh-x0766",
        "mArh-x0792",
        "mArh-x0796",
        "mArh-x0797",
        "mArh-x0805",
        "mArh-x0814",
        "mArh-x0822",
        "mArh-x0837",
        "mArh-x0844",
        "mArh-x0849",
        "mArh-x0852",
        "mArh-x0855",
        "mArh-x0864",
        "mArh-x0895",
        "mArh-x0900",
        "mArh-x0905",
        "mArh-x0910",
        "mArh-x0918",
        "mArh-x0926",
        "mArh-x0933",
        "mArh-x0950",
        "mArh-x0962",
        "mArh-x0967",
        "mArh-x0969",
        "mArh-x1012",
        "mArh-x1015",
        "mArh-x1018",
        "mArh-x1092",
    ],
    "Mpro": [
        "Mpro-N0029A",
        "Mpro-N0029B",
        "Mpro-N0050A",
        "Mpro-N0050B",
        "Mpro-N0066A",
        "Mpro-N0066B",
        "Mpro-x0072A",
        "Mpro-x0104A",
        "Mpro-x0107A",
        "Mpro-x0161A",
        "Mpro-x0165A",
        "Mpro-x0177A",
        "Mpro-x0194A",
        "Mpro-x0195A",
        "Mpro-x0305A",
        "Mpro-x0336A",
        "Mpro-x0350A",
        "Mpro-x0354A",
        "Mpro-x0376A",
        "Mpro-x0387A",
        "Mpro-x0390A",
        "Mpro-x0395A",
        "Mpro-x0397A",
        "Mpro-x0398A",
        "Mpro-x0425A",
        "Mpro-x0426A",
        "Mpro-x0434A",
        "Mpro-x0464A",
        "Mpro-x0478A",
        "Mpro-x0499A",
        "Mpro-x0540A",
        "Mpro-x0669A",
        "Mpro-x0678A",
        "Mpro-x0689A",
        "Mpro-x0691A",
        "Mpro-x0692A",
        "Mpro-x0705A",
        "Mpro-x0708A",
        "Mpro-x0731A",
        "Mpro-x0734A",
        "Mpro-x0736A",
        "Mpro-x0749A",
        "Mpro-x0752A",
        "Mpro-x0755A",
        "Mpro-x0755",
        "Mpro-x0759A",
        "Mpro-x0769A",
        "Mpro-x0769",
        "Mpro-x0770A",
        "Mpro-x0771A",
        "Mpro-x0774A",
        "Mpro-x0786A",
        "Mpro-x0820A",
        "Mpro-x0830A",
        "Mpro-x0831A",
        "Mpro-x0874A",
        "Mpro-x0887A",
        "Mpro-x0946A",
        "Mpro-x0967A",
        "Mpro-x0978A",
        "Mpro-x0981A",
        "Mpro-x0991A",
        "Mpro-x0995A",
        "Mpro-x10019A",
        "Mpro-x10022A",
        "Mpro-x1002A",
        "Mpro-x10049A",
        "Mpro-x10082A",
        "Mpro-x1012A",
        "Mpro-x10150A",
        "Mpro-x10155A",
        "Mpro-x10172A",
        "Mpro-x10178A",
        "Mpro-x10201A",
        "Mpro-x10236A",
        "Mpro-x10237A",
        "Mpro-x10247A",
        "Mpro-x10248A",
        "Mpro-x10296A",
        "Mpro-x10306A",
        "Mpro-x10314A",
        "Mpro-x10322A",
        "Mpro-x10324A",
        "Mpro-x10327A",
        "Mpro-x10329A",
        "Mpro-x10334A",
        "Mpro-x10338A",
        "Mpro-x10355A",
        "Mpro-x10359A",
        "Mpro-x10371A",
        "Mpro-x10377A",
        "Mpro-x10387A",
        "Mpro-x10392A",
        "Mpro-x10395A",
        "Mpro-x10396A",
        "Mpro-x10403A",
        "Mpro-x10417A",
        "Mpro-x10419A",
        "Mpro-x10421A",
        "Mpro-x10422A",
        "Mpro-x10423A",
        "Mpro-x10466A",
        "Mpro-x10473A",
        "Mpro-x10474A",
        "Mpro-x10476A",
        "Mpro-x10478A",
        "Mpro-x10484A",
        "Mpro-x10488A",
        "Mpro-x10494A",
        "Mpro-x10506A",
        "Mpro-x10513A",
        "Mpro-x10525A",
        "Mpro-x10535A",
        "Mpro-x10555A",
        "Mpro-x10559A",
        "Mpro-x10565A",
        "Mpro-x10566A",
        "Mpro-x10575A",
        "Mpro-x10598A",
        "Mpro-x10604A",
        "Mpro-x10606A",
        "Mpro-x10610A",
        "Mpro-x10626A",
        "Mpro-x10638A",
        "Mpro-x10645A",
        "Mpro-x10678A",
        "Mpro-x10679A",
        "Mpro-x10700A",
        "Mpro-x10710A",
        "Mpro-x10723A",
        "Mpro-x10728A",
        "Mpro-x10733A",
        "Mpro-x10756A",
        "Mpro-x1077A",
        "Mpro-x10787A",
        "Mpro-x10789A",
        "Mpro-x10800A",
        "Mpro-x10801A",
        "Mpro-x10812A",
        "Mpro-x10820A",
        "Mpro-x10834A",
        "Mpro-x10856A",
        "Mpro-x10862A",
        "Mpro-x10862",
        "Mpro-x1086A",
        "Mpro-x10870A",
        "Mpro-x10871A",
        "Mpro-x10876A",
        "Mpro-x10888A",
        "Mpro-x10889A",
        "Mpro-x10889",
        "Mpro-x10898A",
        "Mpro-x10899A",
        "Mpro-x10900A",
        "Mpro-x10906A",
        "Mpro-x1093A",
        "Mpro-x10942A",
        "Mpro-x10959A",
        "Mpro-x10976A",
        "Mpro-x10995A",
        "Mpro-x10996A",
        "Mpro-x11001A",
        "Mpro-x11011A",
        "Mpro-x11013A",
        "Mpro-x1101A",
        "Mpro-x1101",
        "Mpro-x11025A",
        "Mpro-x11041A",
        "Mpro-x11044A",
        "Mpro-x11159A",
        "Mpro-x11164A",
        "Mpro-x11186A",
        "Mpro-x1119A",
        "Mpro-x1119",
        "Mpro-x11204A",
        "Mpro-x11208A",
        "Mpro-x11212A",
        "Mpro-x11223A",
        "Mpro-x11225A",
        "Mpro-x11231A",
        "Mpro-x11233A",
        "Mpro-x11254A",
        "Mpro-x11258A",
        "Mpro-x11271A",
        "Mpro-x11276A",
        "Mpro-x11294A",
        "Mpro-x11313A",
        "Mpro-x11317A",
        "Mpro-x11318A",
        "Mpro-x1132A",
        "Mpro-x11339A",
        "Mpro-x11346A",
        "Mpro-x11354A",
        "Mpro-x11366A",
        "Mpro-x11368A",
        "Mpro-x11372A",
        "Mpro-x11417A",
        "Mpro-x11424A",
        "Mpro-x11426A",
        "Mpro-x11427A",
        "Mpro-x11428A",
        "Mpro-x11431A",
        "Mpro-x11432A",
        "Mpro-x11454A",
        "Mpro-x11458A",
        "Mpro-x11473A",
        "Mpro-x11475A",
        "Mpro-x11485A",
        "Mpro-x11488A",
        "Mpro-x11493A",
        "Mpro-x11498A",
        "Mpro-x11499A",
        "Mpro-x11501A",
        "Mpro-x11507A",
        "Mpro-x11508A",
        "Mpro-x11513A",
        "Mpro-x11530A",
        "Mpro-x11532A",
        "Mpro-x11540A",
        "Mpro-x11541A",
        "Mpro-x11542A",
        "Mpro-x11543A",
        "Mpro-x11548A",
        "Mpro-x11557A",
        "Mpro-x11560A",
        "Mpro-x11562A",
        "Mpro-x11564A",
        "Mpro-x11579A",
        "Mpro-x11587A",
        "Mpro-x11590A",
        "Mpro-x11609A",
        "Mpro-x11612A",
        "Mpro-x11616A",
        "Mpro-x1163A",
        "Mpro-x11641A",
        "Mpro-x11642A",
        "Mpro-x11708A",
        "Mpro-x11723A",
        "Mpro-x11742A",
        "Mpro-x11743A",
        "Mpro-x11757A",
        "Mpro-x11764A",
        "Mpro-x11789A",
        "Mpro-x11790A",
        "Mpro-x11797A",
        "Mpro-x11798A",
        "Mpro-x11801A",
        "Mpro-x11809A",
        "Mpro-x11810A",
        "Mpro-x11812A",
        "Mpro-x11813A",
        "Mpro-x11831A",
        "Mpro-x11852A",
        "Mpro-x1187A",
        "Mpro-x11894A",
        "Mpro-x12000A",
        "Mpro-x12025A",
        "Mpro-x12025",
        "Mpro-x12026A",
        "Mpro-x12064A",
        "Mpro-x12073A",
        "Mpro-x12080A",
        "Mpro-x12136A",
        "Mpro-x12143A",
        "Mpro-x12171A",
        "Mpro-x12177A",
        "Mpro-x12202A",
        "Mpro-x12204A",
        "Mpro-x12207A",
        "Mpro-x1226A",
        "Mpro-x12300A",
        "Mpro-x12321A",
        "Mpro-x12350A",
        "Mpro-x1235A",
        "Mpro-x1235",
        "Mpro-x1237A",
        "Mpro-x12419A",
        "Mpro-x12423A",
        "Mpro-x1249A",
        "Mpro-x1308A",
        "Mpro-x1308",
        "Mpro-x1311A",
        "Mpro-x1334A",
        "Mpro-x1334",
        "Mpro-x1336A",
        "Mpro-x1348A",
        "Mpro-x1351A",
        "Mpro-x1358A",
        "Mpro-x1374A",
        "Mpro-x1375A",
        "Mpro-x1380A",
        "Mpro-x1382A",
        "Mpro-x1384A",
        "Mpro-x1385A",
        "Mpro-x1386A",
        "Mpro-x1392A",
        "Mpro-x1402A",
        "Mpro-x1412A",
        "Mpro-x1418A",
        "Mpro-x1425A",
        "Mpro-x1458A",
        "Mpro-x1478A",
        "Mpro-x1493A",
        "Mpro-x2052A",
        "Mpro-x2097A",
        "Mpro-x2119A",
        "Mpro-x2193A",
        "Mpro-x2540A",
        "Mpro-x2562A",
        "Mpro-x2563A",
        "Mpro-x2569A",
        "Mpro-x2572A",
        "Mpro-x2581A",
        "Mpro-x2600A",
        "Mpro-x2608A",
        "Mpro-x2643A",
        "Mpro-x2646A",
        "Mpro-x2649A",
        "Mpro-x2659A",
        "Mpro-x2694A",
        "Mpro-x2703A",
        "Mpro-x2705A",
        "Mpro-x2754A",
        "Mpro-x2764A",
        "Mpro-x2776A",
        "Mpro-x2779A",
        "Mpro-x2908A",
        "Mpro-x2910A",
        "Mpro-x2912A",
        "Mpro-x2929A",
        "Mpro-x2964A",
        "Mpro-x2971A",
        "Mpro-x3077A",
        "Mpro-x3080A",
        "Mpro-x3108A",
        "Mpro-x3110A",
        "Mpro-x3113A",
        "Mpro-x3115A",
        "Mpro-x3117A",
        "Mpro-x3124A",
        "Mpro-x3298A",
        "Mpro-x3303A",
        "Mpro-x3305A",
        "Mpro-x3305",
        "Mpro-x3324A",
        "Mpro-x3325A",
        "Mpro-x3333A",
        "Mpro-x3348A",
        "Mpro-x3351A",
        "Mpro-x3351",
        "Mpro-x3359A",
        "Mpro-x3366A",
    ],
    "MUREECA": [
        "MUREECA-x0114",
        "MUREECA-x0164",
        "MUREECA-x0169",
        "MUREECA-x0172",
        "MUREECA-x0198",
        "MUREECA-x0206",
        "MUREECA-x0215",
        "MUREECA-x0234",
        "MUREECA-x0244",
    ],
    "NUDT21A": [
        "NUDT21A-x0159",
        "NUDT21A-x0203",
        "NUDT21A-x0266",
        "NUDT21A-x0368",
        "NUDT21A-x0404",
        "NUDT21A-x0489",
        "NUDT21A-x0498",
        "NUDT21A-x0502",
        "NUDT21A-x0503",
        "NUDT21A-x0581",
        "NUDT21A-x0584",
        "NUDT21A-x0659",
        "NUDT21A-x0703",
        "NUDT21A-x0743",
        "NUDT21A-x0750",
        "NUDT21A-x0798",
        "NUDT21A-x0896",
        "NUDT21A-x0930",
        "NUDT21A-x0935",
        "NUDT21A-x0936",
        "NUDT21A-x0942",
        "NUDT21A-x0948",
        "NUDT21A-x0964",
        "NUDT21A-x0967",
        "NUDT21A-x0969",
        "NUDT21A-x0974",
        "NUDT21A-x0976",
        "NUDT21A-x1046",
        "NUDT21A-x1047",
        "NUDT21A-x1065",
        "NUDT21A-x1068",
    ],
    "NUDT5A": [
        "NUDT5A-x0114",
        "NUDT5A-x0125",
        "NUDT5A-x0158",
        "NUDT5A-x0169",
        "NUDT5A-x0171",
        "NUDT5A-x0176",
        "NUDT5A-x0177",
        "NUDT5A-x0244",
        "NUDT5A-x0256",
        "NUDT5A-x0262",
        "NUDT5A-x0286",
        "NUDT5A-x0299",
        "NUDT5A-x0319",
        "NUDT5A-x0320",
        "NUDT5A-x0333",
        "NUDT5A-x0339",
        "NUDT5A-x0392",
        "NUDT5A-x0403",
        "NUDT5A-x0412",
        "NUDT5A-x0463",
        "NUDT5A-x0469",
        "NUDT5A-x0525",
        "NUDT5A-x0526",
        "NUDT5A-x0552",
        "NUDT5A-x0554",
        "NUDT5A-x0574",
        "NUDT5A-x0600",
        "NUDT5A-x0605",
        "NUDT5A-x0627",
        "NUDT5A-x0637",
        "NUDT5A-x0651",
        "NUDT5A-x0673",
        "NUDT5A-x0681",
        "NUDT5A-x0685",
        "NUDT5A-x0692",
        "NUDT5A-x1004",
        "NUDT5A-x1024",
        "NUDT5A-x1028",
        "NUDT5A-x1039",
        "NUDT5A-x1066",
        "NUDT5A-x1072",
        "NUDT5A-x1078",
        "NUDT5A-x1083",
        "NUDT5A-x1093",
        "NUDT5A-x1211",
        "NUDT5A-x1212",
        "NUDT5A-x1213",
        "NUDT5A-x1214",
        "NUDT5A-x1217",
        "NUDT5A-x1219",
        "NUDT5A-x1223",
        "NUDT5A-x1235",
        "NUDT5A-x1242",
        "NUDT5A-x1291",
        "NUDT5A-x1298",
    ],
    "NUDT7A": [
        "NUDT7A-x0140",
        "NUDT7A-x0149",
        "NUDT7A-x0151",
        "NUDT7A-x0159",
        "NUDT7A-x0220",
        "NUDT7A-x0254",
        "NUDT7A-x0286",
        "NUDT7A-x0299",
        "NUDT7A-x0303",
        "NUDT7A-x0304",
        "NUDT7A-x0374",
    ],
    "OXA10OTA": [
        "OXA10OTA-x0038",
        "OXA10OTA-x0049",
        "OXA10OTA-x0051",
        "OXA10OTA-x0053",
        "OXA10OTA-x0059",
        "OXA10OTA-x0073",
        "OXA10OTA-x0074",
        "OXA10OTA-x0079",
        "OXA10OTA-x0106",
        "OXA10OTA-x0108",
    ],
    "PARP14A": [
        "PARP14A-x0137",
        "PARP14A-x0161",
        "PARP14A-x0202",
        "PARP14A-x0238",
        "PARP14A-x0266",
        "PARP14A-x0315",
        "PARP14A-x0324",
        "PARP14A-x0334",
        "PARP14A-x0412",
        "PARP14A-x0457",
        "PARP14A-x0473",
        "PARP14A-x0484",
        "PARP14A-x0505",
        "PARP14A-x0567",
        "PARP14A-x0590",
        "PARP14A-x0637",
        "PARP14A-x0690",
        "PARP14A-x0712",
    ],
    "PHIPA": [
        "PHIPA-x20023",
        "PHIPA-x20028",
        "PHIPA-x20029",
        "PHIPA-x20030",
        "PHIPA-x20033",
        "PHIPA-x20045",
        "PHIPA-x20062",
        "PHIPA-x20065",
        "PHIPA-x20076",
        "PHIPA-x20167",
        "PHIPA-x20175",
        "PHIPA-x20330",
        "PHIPA-x20337",
        "PHIPA-x20370",
        "PHIPA-x20404",
        "PHIPA-x20442",
        "PHIPA-x20453",
        "PHIPA-x20463",
        "PHIPA-x20477",
        "PHIPA-x20485",
        "PHIPA-x20529",
        "PHIPA-x20548",
        "PHIPA-x20551",
        "PHIPA-x20552",
        "PHIPA-x20561",
        "PHIPA-x20566",
        "PHIPA-x20584",
        "PHIPA-x20594",
        "PHIPA-x20595",
        "PHIPA-x20631",
        "PHIPA-x20633",
        "PHIPA-x20651",
        "PHIPA-x20667",
        "PHIPA-x20671",
        "PHIPA-x20678",
        "PHIPA-x20712",
        "PHIPA-x20719",
        "PHIPA-x20767",
        "PHIPA-x20801",
        "PHIPA-x20826",
        "PHIPA-x20831",
        "PHIPA-x20833",
        "PHIPA-x20890",
        "PHIPA-x20899",
        "PHIPA-x20906",
        "PHIPA-x20910",
        "PHIPA-x20916",
        "PHIPA-x20971",
        "PHIPA-x21004",
    ],
    "STAG1A": [
        "STAG1A-x0237",
        "STAG1A-x0245",
        "STAG1A-x0457",
        "STAG1A-x0488",
        "STAG1A-x0515",
        "STAG1A-x0521",
        "STAG1A-x0531",
        "STAG1A-x0583",
        "STAG1A-x0627",
        "STAG1A-x0720",
        "STAG1A-x0894",
        "STAG1A-x0921",
        "STAG1A-x0996",
        "STAG1A-x1055",
    ],
    "TBXTA": [
        "TBXTA-x0024",
        "TBXTA-x0076",
        "TBXTA-x0093",
        "TBXTA-x0096",
        "TBXTA-x0113",
        "TBXTA-x0114",
        "TBXTA-x0124",
        "TBXTA-x0128",
        "TBXTA-x0144",
        "TBXTA-x0164",
        "TBXTA-x0167",
        "TBXTA-x0179",
        "TBXTA-x0204",
        "TBXTA-x0229",
        "TBXTA-x0244",
        "TBXTA-x0249",
        "TBXTA-x0258",
        "TBXTA-x0316",
        "TBXTA-x0338",
        "TBXTA-x0353",
        "TBXTA-x0368",
        "TBXTA-x0390",
        "TBXTA-x0409",
        "TBXTA-x0464",
        "TBXTA-x0465",
        "TBXTA-x0491",
        "TBXTA-x0500",
        "TBXTA-x0506",
        "TBXTA-x0530",
        "TBXTA-x0545",
        "TBXTA-x0552",
        "TBXTA-x0563",
        "TBXTA-x0567",
        "TBXTA-x0744",
        "TBXTA-x0753",
        "TBXTA-x0773",
        "TBXTA-x0776",
        "TBXTA-x0786",
        "TBXTA-x0820",
        "TBXTA-x0830",
        "TBXTA-x0835",
        "TBXTA-x0938",
        "TBXTA-x0948",
        "TBXTA-x0986",
        "TBXTA-x0992",
        "TBXTA-x1079",
        "TBXTA-x1161",
        "TBXTA-x1164",
        "TBXTA-x1174",
    ],
    "TNCA": ["TNCA-x0062",
             "TNCA-x0063",
             "TNCA-x0084",
             "TNCA-x0100",
             "TNCA-x0107",
             "TNCA-x0141",
             "TNCA-x0146",
             "TNCA-x0162",
             "TNCA-x0179",
             "TNCA-x0192",
             "TNCA-x0228",
             "TNCA-x0245",
             "TNCA-x0290",
             "TNCA-x0291",
             "TNCA-x0296",
             "TNCA-x0323",
             "TNCA-x0334",
             ],
    "VIM2": ["VIM2-x1057",
             "VIM2-x1237",
             "VIM2-x1238",
             "VIM2-x1243",
             "VIM2-x1247",
             "VIM2-x1251",
             "VIM2-x1261",
             "VIM2-x1264",
             "VIM2-x1282",
             "VIM2-x1291",
             "VIM2-x1294"
             ],
    "XX02KALRNA": [
        "XX02KALRNA-x1376",
        "XX02KALRNA-x1377",
        "XX02KALRNA-x1388",
        "XX02KALRNA-x1389",
        "XX02KALRNA-x1449",
        "XX02KALRNA-x1453",
        "XX02KALRNA-x1463",
        "XX02KALRNA-x1480",
        "XX02KALRNA-x1483",
        "XX02KALRNA-x1490",
        "XX02KALRNA-x1492",
        "XX02KALRNA-x1505",
    ]
}


def main(container_path: str):
    print("Starting")
    # Define data
    container_path = Path(container_path)
    data_dirs = Path('/opt/clusterscratch/pandda/data')
    results_dirs = Path('/opt/clusterscratch/pandda/output/pandda_cluster_results')
    ignores = ['containers', 'pandda_results', 'scripts']

    # Get Scheduler
    print("Getting scheduler")
    schedd = htcondor.Schedd()  # get the Python representation of the scheduler

    # Loop over PanDDA data dirs
    paths = [path for path in data_dirs.glob("*")]

    jobs = {}


    for data_dir in paths:
        print(f"\tProcessing: {data_dir}")
        system_name = data_dir.name
        print(f"\t\tSystem name is: {system_name}")
        out_dir = results_dirs / system_name
        print(f"\t\tOut dir is: {out_dir}")
        # If not a directory, continue
        if not data_dir.is_dir():
            continue

        # TODO: REMOVE
        if not system_name == "TNCA":
            continue

        # Check if should ignore because not pandda data
        if data_dir.name in ignores:
            print(f"\t\tSkipped: {data_dir}: not pandda data")
            continue

        # Check if should ignore because already got results
        event_table_file = out_dir / 'analyses' / 'pandda_analyse_events.csv'
        if event_table_file.exists():
            print(f"\t\tSkipped: {data_dir}: not already has analyse events")
            continue

        # Check if should ignore because have no high confidence hits
        if system_name not in high_confidence_structure_dict:
            print("Don't have any high confidence hits for this system! Skipping!")
            continue

        # Check if should ignore because currently running
        pandda_log_file = out_dir / 'pandda_log.json'
        if pandda_log_file.exists():
            print(f"\t\tSkipped: {data_dir}: already started!")
            continue

        # Get the datasets that are worth running because they have hits to check
        system_high_confidence_dtags = high_confidence_structure_dict[system_name]

        # If not generate job script
        script = SCRIPT.format(
            data_dirs=str(data_dir),
            out_dir=str(out_dir),
            only_datasets=str(",".join(system_high_confidence_dtags))
        )
        print(f"\t\tScript is: {script}")

        # Write job script
        pandda_script_file = results_dirs / f"{system_name}.sh"
        with open(pandda_script_file, "w") as f:
            f.write(script)

        os.chmod(str(pandda_script_file), 0o777)

        # Generate the args for singularity
        singularity_script = SINGULARITY_SCRIPT.format(
            personal_container_path=str(container_path),
            pandda_script=str(pandda_script_file),
        )
        print(f"\t\tsingularity_script are: {singularity_script}")

        # Write singularity script
        singularity_script_file = results_dirs / f"{system_name}.singularity.sh"
        with open(singularity_script_file, "w") as f:
            f.write(singularity_script)

        os.chmod(str(singularity_script_file), 0o777)

        # Generate job
        job_dict = {
            "executable": f"{str(singularity_script_file)}",  # the program to run on the execute node
            # "arguments": arguments,
            "output": str(results_dirs / f"{system_name}.out"),
            # anything the job prints to standard output will end up in this file
            "error": str(results_dirs / f"{system_name}.err"),
            # anything the job prints to  standard error will end up in this file
            "log": str(results_dirs / f"{system_name}.log"),
            # this file will contain a record  of what happened to the job
            "request_cpus": "47",  # how many CPU cores we want
            "request_memory": "300GB",  # how much memory we want
        }
        job = htcondor.Submit(job_dict)

        # Submit job
        submit_result = schedd.submit(job)
        print(f"\t\tSubmitted!")
        time.sleep(20)

        jobs[system_name] = submit_result

        query = schedd.query()

        # print(query)

        num_jobs = len(query)
        while num_jobs > 10:
            print(f"\t\t\tToo many jobs: {len(query)} at once, hold on there!")
            status = {_system_name: len(schedd.query(constraint=f"ClusterId == {_submit_result.cluster()}"))
                      for _system_name, _submit_result
                      in jobs.items()
                      }
            print(status)
            time.sleep(10)
            num_jobs = sum([length for length in status.values()])


if __name__ == "__main__":
    fire.Fire(main)
